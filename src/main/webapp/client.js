var clientVersion="javascript_2.5.1";var protocolVersion="1.0.0";var maxDeletedEvents=10;var IE_BROWSER=1;var FIREFOX_BROWSER=2;var SAFARI_BROWSER=3;var KC_BACKSPACE=8;var KC_BACKSPACE_IPHONE=127;var KC_TAB=9;var KC_ENTER=13;var KC_SHIFT=16;var KC_CTRL=17;var KC_ALT=18;var KC_PAUSE_BREAK=19;var KC_CAPS_LOCK=20;var KC_ESCAPE=27;var KC_PAGE_UP=33;var KC_PAGE_DOWN=34;var KC_END=35;var KC_HOME=36;var KC_LEFT_ARROW=37;var KC_UP_ARROW=38;var KC_RIGHT_ARROW=39;var KC_DOWN_ARROW=40;var KC_INSERT=45;var KC_DELETE=46;var KC_0=48;var KC_1=49;var KC_2=50;var KC_3=51;var KC_4=52;var KC_5=53;var KC_6=54;var KC_7=55;var KC_8=56;var KC_9=57;var KC_A=65;var KC_B=66;var KC_C=67;var KC_D=68;var KC_E=69;var KC_F=70;var KC_G=71;var KC_H=72;var KC_I=73;var KC_J=74;var KC_K=75;var KC_L=76;var KC_M=77;var KC_N=78;var KC_O=79;var KC_P=80;var KC_Q=81;var KC_R=82;var KC_S=83;var KC_T=84;var KC_U=85;var KC_V=86;var KC_W=87;var KC_X=88;var KC_Y=89;var KC_Z=90;var KC_LEFT_WINDOW=91;var KC_RIGHT_WINDOW=92;var KC_SELECT=93;var KC_NUMPAD_0=96;var KC_NUMPAD_1=97;var KC_NUMPAD_2=98;var KC_NUMPAD_3=99;var KC_NUMPAD_4=100;var KC_NUMPAD_5=101;var KC_NUMPAD_6=102;var KC_NUMPAD_7=103;var KC_NUMPAD_8=104;var KC_NUMPAD_9=105;var KC_MULTIPLY=106;var KC_ADD=107;var KC_SUBTRACT=109;var KC_DECIMAL_POINT=110;var KC_DIVIDE=111;var KC_F1=112;var KC_F2=113;var KC_F3=114;var KC_F4=115;var KC_F5=116;var KC_F6=117;var KC_F7=118;var KC_F8=119;var KC_F9=120;var KC_F10=121;var KC_F11=122;var KC_F12=123;var KC_NUM_LOCK=144;var KC_SCROLL_LOCK=145;var KC_SEMI_COLON=186;var KC_EQUAL_SIGN=187;var KC_COMMA=188;var KC_DASH=189;var KC_PERIOD=190;var KC_FORWARD_SLASH=191;var KC_GRAVE_ACCENT=192;var KC_OPEN_BRACKET=219;var KC_SLASH=220;var KC_CLOSE_BRAKET=221;var KC_SINGLE_QUOTE=222;var numberDeletions=0;var useTab=0;var useEnter=0;var useClick=0;function test(){alert("test")}function clear(b){var c=document.forms[0];var a=(b.srcElement)?(b.srcElement):(b.target);if(b.type=="click"){useClick=1}if(b.type=="keydown"&&(b.keyCode==KC_BACKSPACE||b.keyCode==KC_BACKSPACE_IPHONE)){numberDeletions++}a.value="";a.events=new Array();a.deletedEvents=new Array();a.eventCounter=0;a.avoidKeyUpEvents=new Array()}var tabPressed=false;function deleteLastEvent(c){for(var b=c.events.length-1;b>=0;b--){var d=c.events[b];if(d.type=="keydown"&&d.deletedEvent==false){d.deletedEvent=true;var a=0;for(var b=0;b<c.value.length;b++){var e=c.value.charAt(b);if(/^[A-Z,a-z,0-9]$/.test(e)){a++}}if(a){c.deletedEvents.push(a)}return}}}function addNewEvent(a,b,c){a.events.push({type:b.type,keyCode:b.keyCode,time:c,deletedEvent:false})}function processEvent(e,a){var g=(new Date()).getTime();var c=0;var b=(e.srcElement)?(e.srcElement):(e.target);if(b.events===undefined){return}if(e.keyCode==KC_DELETE||e.keyCode==KC_LEFT_ARROW||e.keyCode==KC_RIGHT_ARROW||e.keyCode==KC_HOME||e.keyCode==KC_PAGE_UP||e.keyCode==KC_PAGE_DOWN){c=1}else{if(e.keyCode==KC_BACKSPACE||(e.keyCode==KC_BACKSPACE_IPHONE&&a==SAFARI_BROWSER)){if(b.deleteFieldByChar==true&&b.deletedEvents.length<=maxDeletedEvents){if(e.type=="keydown"){if(b.value.length>0){var f=b.value.charAt(b.value.length-1);if(/^[A-Z,a-z,0-9]$/.test(f)){deleteLastEvent(b)}}}}else{clear(e);c=1}}else{if(e.keyCode==KC_TAB&&!e.shiftKey){if(e.type=="keydown"){useTab=1;tabPressed=true;c=1}}var h=e.keyCode>=KC_A&&e.keyCode<=KC_Z;if(h||(e.keyCode>=KC_0&&e.keyCode<=KC_9)||(e.keyCode>=KC_NUMPAD_0&&e.keyCode<=KC_NUMPAD_9)){if(e.type=="keydown"){if(e.altKey||e.ctrlKey||(e.shiftKey&&!h)){b.avoidKeyUpEvents[e.keyCode]=true}else{b.eventCounter++;addNewEvent(b,e,g)}}else{if(e.type=="keyup"){if(b.avoidKeyUpEvents[e.keyCode]!=true){b.eventCounter--;addNewEvent(b,e,g)}else{b.avoidKeyUpEvents[e.keyCode]=false}}}}}}if(tabPressed&&b.eventCounter==0){try{b.next.focus()}catch(d){}tabPressed=false}if(e.keyCode==KC_ENTER){useEnter=1}return c}function captureTimeIE(b){var a=processEvent(b,IE_BROWSER);if(a){b.returnValue=false}}function captureTimeSafari(b){var a=processEvent(b,SAFARI_BROWSER);if(a){b.returnValue=false}}function captureTimeFirefox(b){var a=processEvent(b,FIREFOX_BROWSER);if(a){b.preventDefault()}}function AuthentestSignature(){var a=new Date();var c;if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){c=navigator.language}if((/MSIE (\d+\.\d+);/.test(navigator.userAgent))||(/Trident[\/\s](\d+\.\d+);.*rv\:1/.test(navigator.userAgent))){c=navigator.userLanguage}if(/Safari[\/\s](\d+\.\d+)/.test(navigator.userAgent)){c=navigator.language}this.enviroment={navigator:{appCodeName:navigator.appCodeName+"",appName:navigator.appName+"",appVersion:navigator.appVersion+"",language:c+"",platform:navigator.platform+"",userAgent:navigator.userAgent+""},timeZone:((a.getTimezoneOffset()/60)*-1),hour:a.getTime(),scrResolution:screen.width+"x"+screen.height,clientVersion:clientVersion,protocolVersion:protocolVersion};this.behavior={referrer:document.referrer,numberDeletions:0,useTab:0,useClick:0,useEnter:0};this.bioRecord=new Array();var b=new Array();this.getElement=function(f){var d=document.getElementById(f);if(null==d){var e=document.getElementsByName(f);if(e.length){d=e[0]}}return d};this.addObservedField=function(k,f,h,i){var j=false;if(typeof h=="boolean"){j=h}var d=k;if(typeof i=="string"){d=i}var e=this.getElement(k);var g=this.getElement(f);if(e&&g){if(e.type=="text"||e.type=="password"){e.value="";e.eventCounter=0;e.events=new Array();e.deletedEvents=new Array();e.avoidKeyUpEvents=new Array();e.next=g;e.deleteFieldByChar=j;b.push({id:k,logicalName:d,processField:true});this.includeField(k)}}};this.includeField=function(f){var d=this.getElement(f);if(d){if((/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||(/Trident[\/\s](\d+\.\d+);.*rv\:1/.test(navigator.userAgent))){d.addEventListener("click",clear,false);d.addEventListener("focus",clear,false);d.addEventListener("keydown",captureTimeFirefox,false);d.addEventListener("keyup",captureTimeFirefox,false)}if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){d.attachEvent("onclick",clear,false);d.attachEvent("onfocus",clear,false);d.attachEvent("onkeydown",captureTimeIE,false);d.attachEvent("onkeyup",captureTimeIE,false)}if(/Safari[\/\s](\d+\.\d+)/.test(navigator.userAgent)){d.addEventListener("click",clear,false);d.addEventListener("focus",clear,false);d.addEventListener("keydown",captureTimeSafari,false);d.addEventListener("keyup",captureTimeSafari,false)}for(var e=0;e<b.length;e++){if(b[e].id==f){b[e].process=true}}}};this.excludeField=function(f){var d=this.getElement(f);if(d){if(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent)){d.removeEventListener("click",clear,false);d.removeEventListener("focus",clear,false);d.removeEventListener("keydown",captureTimeFirefox,false);d.removeEventListener("keyup",captureTimeFirefox,false)}if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){d.detachEvent("onclick",clear,false);d.detachEvent("onfocus",clear,false);d.detachEvent("onkeydown",captureTimeIE,false);d.detachEvent("onkeyup",captureTimeIE,false)}if(/Safari[\/\s](\d+\.\d+)/.test(navigator.userAgent)){d.removeEventListener("click",clear,false);d.removeEventListener("focus",clear,false);d.removeEventListener("keydown",captureTimeSafari,false);d.removeEventListener("keyup",captureTimeSafari,false)}for(var e=0;e<b.length;e++){if(b[e].id==f){b[e].process=false}}}};this.getReady=function(g){var e="_AuthentestSignature";if(b.length==0){return false}var k=this.getElement(b[0].id);if(k){var f=this.getElement(e);if(!f){var q=k.form;f=document.createElement("INPUT");f.type="hidden";f.name=e;f.id=e;q.appendChild(f)}}else{return false}this.behavior.numberDeletions=numberDeletions;this.behavior.useTab=useTab;this.behavior.useClick=useClick;this.behavior.useEnter=useEnter;this.bioRecord=new Array();for(var p=0;p<b.length;p++){if(b[p].process){var k=this.getElement(b[p].id);if(k){var d={id:b[p].logicalName};var h=0;var m=0;if(k.events.length>0){this.normalizeEventsTime(k.events)}d.deletedEvents=k.deletedEvents;if(k.deletedEvents.length>0){this.behavior.numberDeletions+=k.deletedEvents.length}var n=0;for(var j=0;j<k.value.length;j++){var l=k.value.charAt(j);if(/^[A-Z,a-z,0-9]$/.test(l)){n++}}var o=this.processEvents(b[p].id,d);if(!o){return false}this.bioRecord.push(d)}}}if(g){f.value=this.compressSignature()}else{f.value=this}return true};this.compressSignature=function(){var e=new AuthentestSignatureDeflate();var d=e.deflateSignature(this);var g=new EncodeStringOfNumbers();var f=g.encode(d);return f};this.normalizeEventsTime=function(e){var g=parseFloat(e[0].time);for(var d=0;d<e.length;d++){var f=e[d];f.time-=g}};this.processEvents=function(f,d){var j=this.getElement(f);var s=j.events;d.events=new Array();var g=d.deletedEventsIndex=new Array();if(j){this.processEvents_deletedEvents(s,g);var p=new Array();var n=0;for(var k=0;k<j.value.length;k++){var m=j.value.charAt(k);if(/^[A-Z,a-z,0-9]$/.test(m)){var r=j.value.toUpperCase().charCodeAt(k);p.push({keyCode:r,kdIndex:undefined,kdEvent:undefined,kuIndex:undefined,kuEvent:undefined});n++}}d.lastID=n-1;var q=-1;for(var k=0;k<s.length;k++){var e=s[k];if(e.deletedEvent==true){continue}if(e.type=="keydown"){var l=this.processEvents_findNextKeyDown(p,q+1,e.keyCode);if(l>=0){p[l].kdIndex=k;p[l].kdEvent=e;e.id=l;q=l}else{}}else{if(e.type=="keyup"){var h=this.processEvents_findPreviousKeyUp(p,q,e.keyCode);if(h>=0){p[h].kuIndex=k;p[h].kuEvent=e;e.id=h}else{var o=this.processEvents_findNextKeyUp(p,q+1,e.keyCode);if(o>=0){p[o].kuIndex=k;p[o].kuEvent=e;e.id=o}else{}}}}}this.processEvents_generateBioRecord(s,d);return true}return false};this.processEvents_findNextKeyDown=function(f,d,h){var g;if(h>=KC_NUMPAD_0&&h<=KC_NUMPAD_9){g=h-(KC_NUMPAD_0-KC_0)}else{g=h}for(var e=d;e<f.length;e++){if(f[e].keyCode==g){if(f[e].kdEvent==undefined&&f[e].kuEvent==undefined){return e}}}return -1};this.processEvents_findPreviousKeyUp=function(f,d,h){var g;if(h>=KC_NUMPAD_0&&h<=KC_NUMPAD_9){g=h-(KC_NUMPAD_0-KC_0)}else{g=h}for(var e=d;e>=0&&e<f.length;e--){if(g==f[e].keyCode){if(f[e].kuEvent==undefined){return e}else{return -1}}}return -1};this.processEvents_findNextKeyUp=function(f,d,g){for(var e=d;e<f.length;e++){if(f[e].keyCode==g){if(f[e].kuEvent==undefined){return e}}}return -1};this.processEvents_deletedEvents=function(f,g){var d=new Array();for(var e=0;e<f.length;e++){var h=f[e];if(h.type=="keydown"){if(h.deletedEvent==true){d[h.keyCode]=true;g.push(e)}}else{if(h.type=="keyup"){if(d[h.keyCode]==true){if(d[h.keyCode]==true){h.deletedEvent=true;d[h.keyCode]=false;g.push(e)}}}}}};this.processEvents_generateBioRecord=function(e,g){for(var d=0;d<e.length;d++){var f=e[d];if(!f.deletedEvent&&f.id!=undefined){if(f.type=="keydown"){g.events.push({time:f.time,type:"kdn",id:f.id})}if(f.type=="keyup"){g.events.push({time:f.time,type:"kup",id:f.id})}}}};this.deleteSomeEvents=function(d){var e=Math.floor(Math.random()*d.length-1);d.splice(e,1)}}AuthentestSignature.prototype.toString=function(){var c=this;var b=[];function f(a){b[b.length]=a}function d(a){var j,h,e,g;switch(typeof a){case"object":if(a){if(a instanceof Array){f("[");e=b.length;for(h=0;h<a.length;h+=1){g=a[h];if(typeof g!="undefined"&&typeof g!="function"){if(e<b.length){f(",")}d(g)}}f("]");return}else{if(typeof a.valueOf=="function"){f("{");e=b.length;for(h in a){g=a[h];if(typeof g!="undefined"&&typeof g!="function"&&(!g||typeof g!="object"||typeof g.valueOf=="function")){if(e<b.length){f(",")}d(h);f(":");d(g)}}return f("}")}}}f("null");return;case"number":f(isFinite(a)?+a:"null");return;case"string":e=a.length;f('"');for(h=0;h<e;h+=1){j=a.charAt(h);if(j>=" "){if(j=="\\"||j=='"'){f("\\")}f(j)}else{switch(j){case"\b":f("\\b");break;case"\f":f("\\f");break;case"\n":f("\\n");break;case"\r":f("\\r");break;case"\t":f("\\t");break;default:j=j.charCodeAt();f("\\u00"+Math.floor(j/16).toString(16)+(j%16).toString(16))}}}f('"');return;case"boolean":f(String(a));return;default:f("null");return}}d(c);return b.join("").replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")};fillHeadIfNecesary=function(d,a,b){var c;c=d;while(c.toString().length<a){c=b+c}return c};removeHeadIfNecesary=function(c,a){var b=c;while(b.length>0&&b.charAt(0)==a){b=b.substr(1)}return b};fillTailIfNecesary=function(d,a,b){var c;c=d;while(c.toString().length<a){c+=b}return c};removeTailIfNecesary=function(c,a){var b=c;while(b.length>0&&b.charAt(b.length-1)==a){b=b.substr(0,b.length-1)}return b};hashString=function(d){var f=33;var a=5381;var e=999999;var c=a;for(var b=0;b<d.length;b++){c=f*c+d.charCodeAt(b);if(c>e){c=c%e}}return c};function AuthentestSignatureDeflate(){this.sortBioRecordEvents=function(g){var d;var f;var b=new Array();var a;for(var c=0;g.length>c;c++){d=g[c].events;b[c]=new Array();b[c][0]=new Array();b[c][1]=new Array();for(var e=0;e<d.length;e++){f=g[c].events[e];if(f.type=="kdn"){a=parseInt(f.id,10);b[c][0][a]=f.time}else{if(f.type=="kup"){a=parseInt(f.id,10);b[c][1][a]=f.time}}}}return b};this.convertSortBREToRelativeTime=function(a){var e;var d;var c;var b=Number.MAX_VALUE;for(e=0;e<a.length;e++){for(d=0;d<a[e].length;d++){if(a[e][d][0]<b){b=a[e][d][0]}}}for(e=0;e<a.length;e++){for(d=0;d<a[e].length;d++){for(c=0;c<a[e][d].length;c++){a[e][d][c]=a[e][d][c]-b}}}};this.deflateUserAgent=function(a){var b=hashString(a).toString();return fillHeadIfNecesary(b,6,"0")};this.deflateTimeZone=function(a){var b=a+12;return fillHeadIfNecesary(b.toString(),2,"0")};this.deflateNavigator=function(a){return this.deflateUserAgent(a.userAgent)};this.deflateEnviroment=function(b){var a=this.deflateTimeZone(b.timeZone);a+=this.deflateNavigator(b.navigator).toString();return a};this.deflateBehavior=function(b){var c;var a;a=b.useTab<<2;a+=b.useClick<<1;a+=b.useEnter;c=fillHeadIfNecesary(b.numberDeletions.toString(),2,"0");c+=a.toString();return c};this.deflateBioRecordRT=function(b){var c;var a;c=fillHeadIfNecesary(b.length.toString(),2,"0");for(iField=0;iField<b.length;iField++){c+=fillHeadIfNecesary(b[iField].length.toString(),2,"0");for(iEvent=0;iEvent<b[iField].length;iEvent++){c+=fillHeadIfNecesary(b[iField][iEvent].length.toString(),2,"0");for(iEventId=0;iEventId<b[iField][iEvent].length;iEventId++){a=b[iField][iEvent][iEventId];if(a>99999){a=99999}c+=fillHeadIfNecesary(a.toString(),5,"0")}}}return c};this.deflateBioRecord=function(b){var a=this.sortBioRecordEvents(b);this.convertSortBREToRelativeTime(a);return this.deflateBioRecordRT(a)};this.deflateSignature=function(b){var a;a=this.deflateEnviroment(b.enviroment);a+=this.deflateBehavior(b.behavior);a+=this.deflateBioRecord(b.bioRecord);return a}}function EncodeStringOfNumbers(){this.encodeNumber=function(a){var c="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz#*";var d=c.length;var b;var e="";do{b=a%d;b=c.charAt(b);e=b.toString()+e;a=Math.floor(a/d)}while(a!=0);return e};this.encode=function(e){var d="";var a;var c;var b;d=fillHeadIfNecesary(e.length,4,"0");do{a=e.substring(0,15);c=parseInt(a,"10");b=this.encodeNumber(c);if(e.length>15){b=fillHeadIfNecesary(b,9,"+")}d+=b;e=e.substring(15)}while(e.length>0);return d}};